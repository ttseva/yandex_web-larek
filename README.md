# Проектная работа "Веб-ларек"

Стек: HTML, SCSS, TS, Webpack

Структура проекта:
- src/ — исходные файлы проекта
- src/components/ — папка с JS компонентами
- src/components/base/ — папка с базовым кодом

Важные файлы:
- src/pages/index.html — HTML-файл главной страницы
- src/types/index.ts — файл с типами
- src/index.ts — точка входа приложения
- src/scss/styles.scss — корневой файл стилей
- src/utils/constants.ts — файл с константами
- src/utils/utils.ts — файл с утилитами

## Установка и запуск
Для установки и запуска проекта необходимо выполнить команды

```
npm install
npm run start
```

или

```
yarn
yarn start
```
## Сборка

```
npm run build
```

или

```
yarn build
```
## Базовый код
### 1. Класс ```Api```
Класс Api предназначен для упрощения работы с HTTP-запросами к API. Он предоставляет методы для выполнения GET и POST-запросов, а также обработки ответов от сервера.
Методы ```get``` и ```post ``` выполняют GET и POST/PUT/DELETE-запросы соответственно.
```protected handleResponse(response: Response): Promise<object>``` - обрабатывает ответ от сервера.

### 2. Класс ```EventEmitter```
Класс EventEmitter реализует паттерн "Наблюдатель" и используется для управления событиями. Он позволяет подписываться на события, отписываться от них, генерировать события и создавать триггеры для автоматической генерации событий.
Методы ```on```, ```off``` устанавливают и снимают обработчик на событие. ```onAll```, ```offAll``` устанавливают обработчики на все события или сбрасывают их.
```emit<T extends object>(eventName: string, data?: T): void``` - генерирует событие с данными.
```trigger<T extends object>(eventName: string, context?: Partial<T>): (data: T) => void``` - создает триггер, который генерирует событие при вызове.


## Компоненты модели данных (бизнес-логика)
### CatalogueModel 
Содержит данные о каталоге товаров и управляет этим каталогом. Позволяет добавлять товары, получать информацию о конкретном товаре, а также проверять наличие товара в каталоге.
```has``` — проверяет, существует ли товар с указанным идентификатором в каталоге.

### Product 
Содержит информацию о товаре: идентификатор, название и цена товара. 
```price``` — цена товара (null, если цена не указана).
### BasketModel 
Содержит состояние корзины товаров и управляет этим состоянием: добавление товаров в корзину, удаление их; и полностью очистить корзину.

### CheckoutStep
Абстрактный шаг оформления заказа. Содержит базовую логику для шага оформления заказа. Проверяет валидность шага и получает сообщение об ошибке, если шаг не пройден.

### CheckoutStepOne и CheckoutStepTwo 
Шаги оформления заказа с определенными заданием полями.

### CheckoutModel
Управление процессом оформления заказа. 
```isCheckoutComplete``` — проверяет, пройдены ли все шаги оформления. ```submitOrder``` — отправляет заказ на сервер и сбрасывает данные после успешной отправки. ```resetCheckout``` — сбрасывает все данные оформления заказа.

## Компоненты представления
### Modal 
Компонент представления для модального окна. Управляет отображением модального окна, его открытием и закрытием, а также взаимодействием с пользователем.
```setNextStepEnabled``` — активирует или деактивирует кнопку перехода к следующему шагу.
```onClose``` — подписывает на событие закрытия модального окна.
```onNext``` — подписывает на событие перехода к следующему шагу.

### ViewConstructor 
Фабрика для создания компонентов представления. Позволяет создавать экземпляры компонентов, передавая контейнер для отображения и опционально объект событий.
```container``` — контейнер, в который будет отрисован компонент.

### View 
Базовый интерфейс для всех компонентов представления. Определяет метод для отрисовки компонента.

## Типы данных
```
// лист ответов API
export type ApiListResponse< Type> = {\
    total: number, // количество ответов: число элементов \
    items: Type[] // массив типа Type\
};

// перечисление HTTP-методов, которые могут быть использованы для POST-запросов.
export type ApiPostMethods = 'POST' | 'PUT' | 'DELETE';

type EventName = string | RegExp; // имя события
type Subscriber = Function; // функция-обработчик события

// объект события
type EmitterEvent = { 
    eventName: string,
    data: unknown;
};

// поле ввода
export type ICheckoutField = {
    value: string | null;
    setValue: (value: string) => void;
};
```